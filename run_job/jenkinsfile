pipeline {
    agent any
    
    parameters {
        string(name: 'Email', defaultValue: 'suporte.admin@sysvision.global', description: 'Email do TAC')
        string(name: 'Senha', defaultValue: 'Sys@lo321', description: 'Senha do TAC')
        string(name: 'taskId', defaultValue: '33', description: 'Numero da Task')
        // Adicione outros parâmetros conforme necessário
    }

    stages {
        stage('Acessar Servidor e Executar Comando') {
            steps {
                script {
                    sh """
                    sshpass -p 'Sys@lo321' ssh -o StrictHostKeyChecking=no sysvision@10.150.71.101 '
                    cd /opt/Talend-8.0.1/tac/apache-tomcat/webapps/org.talend.administrator/WEB-INF/classes/ &&
                    ./MetaServletCaller.sh \
                    --tac-url=http://10.150.71.101:8080/org.talend.administrator \
                    --json-params=" \
                    { \
                         'actionName': 'runTask',
                        'authPass': '${Senha}',
                        'authUser': '${Email}',
                        'jvmParams': [
                        '-Xmx256m',
                        '-Xms64m'
                        ],
                        'mode': 'synchronous',
                        'taskId': ${taskId}
                    }"
                    ' """
                }
            }
        }
    }
}